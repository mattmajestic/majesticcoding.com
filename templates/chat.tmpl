{{ define "chat" }}
<div class="relative w-full">

  <!-- Chat Toggle Button -->
  <button id="chat-toggle"
          class="absolute top-2 left-2 z-10 p-1 bg-gray-800 rounded text-white focus:outline-none">
    <i id="eye-open" class="fas fa-eye fa-1x"></i>
    <i id="eye-closed" class="fas fa-eye-slash fa-1x hidden"></i>
    <span class="sr-only">Show/Hide Chat</span>
  </button>

  <!-- Chat Hidden Message -->
  <div id="chat-hidden-msg" class="hidden text-white text-lg p-4 text-center">
    ðŸ’¬ Chat is hidden
  </div>

  <!-- Chat Widget Container -->
  <div id="chat-widget"
     class="flex flex-col h-[600px] w-[300px] bg-[#04141d] overflow-hidden">

  <!-- Top header -->
  <div class="flex flex-col p-2">
    <span class="font-bold text-blue-400 text-center text-2xl">ðŸ’¬ Live Chat</span>
    <span class="text-md text-white text-center">Chats delete after 1 Hour ðŸ•“</span>
  </div>

  <!-- Scrollable chat area -->
  <div id="chat-messages"
     class="flex-1 min-h-0 max-h-[500px] overflow-y-auto p-2 text-md font-mono space-y-2">
  </div>

</div>


    <!-- Auth Status Message -->
    <div id="auth-status-message" class="hidden p-3 border-t auth-status-border auth-status-bg text-center">
      <div class="flex flex-col items-center space-y-2">
        <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg">
          <i class="fas fa-lock text-white text-sm"></i>
        </div>
        <div class="px-2">
          <p class="auth-status-title font-semibold text-xs mb-1">Authentication Required</p>
          <p class="auth-status-subtitle text-xs">Sign in to join the conversation</p>
        </div>
        <a href="/auth" class="inline-flex items-center px-3 py-1.5 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-medium text-xs rounded-md shadow-md transition-all duration-200 transform hover:scale-105 w-full max-w-[200px] justify-center">
          <i class="fas fa-sign-in-alt mr-1"></i>
          Sign In
        </a>
      </div>
    </div>

    <!-- Chat Form -->
    <form id="chat-form"
          class="flex items-center p-2 border-t border-gray-700 shrink-0">
      <textarea id="chat-input"
        class="flex-1 px-2 py-1.5 rounded bg-gray-800 text-white border border-gray-700 focus:outline-none focus:ring focus:ring-blue-500 resize-none"
        placeholder="Type a message..." autocomplete="off" rows="1.5"></textarea>
      <button type="button"
              id="insert-ai"
              class="ml-2 px-4 py-1 text-xl font-bold glowing-effect text-gray-900 bg-green-300 rounded transition flex items-center justify-center"
              title="Ask !ai">
        AI
      </button>

      <button type="submit"
              class="ml-2 px-4 py-1 rounded bg-light-blue text-white transition flex items-center justify-center"
              title="Send Chat">
        <i class="fas fa-paper-plane text-xl"></i>
      </button>
    </form>

  {{ template "footer_chat" . }}
  <script src="/static/components/chat.js"></script>
  <script type="module" src="/static/components/supabase-auth.js"></script>
  <script src="/static/components/ws.js"></script>
</div>
{{ end }}
